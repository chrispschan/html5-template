{# formInput element #}
{% macro formInput(id, class, dataset, options) %}
    <{%- if options.fieldset %}fieldset{% else %}div{% endif %}
        {%- if id %} id="{{id}}"{% endif %}
        {#!- #} class="formInput
        {%- if fieldset %} formInput--fieldset{% endif -%}
        {%- for modifier in options.modifier %} formInput--{{ modifier }}{% endfor -%}
        {%- if class %} {{ class }}{% endif -%}"
        {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
        {%- if option.fieldset -%}
            {%- if options.form %} form="{{options.form}}"{%- endif -%}
            {%- if options.name %} name="{{options.name}}"{%- endif -%}
            {%- if options.modifier -%}
                {%- if 'disabled' in options.modifier %} disabled{%- endif -%}
            {%- endif -%}
        {%- endif -%}
    >
        {%- if options.label -%}
            {%- call label(
                id=options.label.id,
                for=options.input.id,
                class=options.label.class,
                dataset=options.label.dataset,
                options=options.label.options
            ) -%}
                {{options.label.text | safe}}
            {%- endcall -%}
        {%- endif -%}
        {%- if options.input -%}
            {%- call wrapper() -%}
                {{- input(
                    id=options.input.id,
                    class=options.input.calss,
                    dataset=options.input.dataset,
                    options=options.input.options
                ) -}}
            {%- endcall -%}
        {%- endif -%}
        
        {{- caller() -}}

        {%- if options.error -%}
            {%- call note(
                id=options.error.id,
                class=options.error.class,
                dataset=options.error.dataset,
                options={
                    modifier: [
                        'error'
                    ]
                }
            ) -%}
                {{options.error.text | safe}}
            {%- endcall -%}
        {%- endif -%}
        {%- if options.note -%}
            {%- call note(
                id=options.note.id,
                class=options.note.class,
                dataset=options.note.dataset,
                options=options.note.options
            ) -%}
                {{options.note.text | safe}}
            {%- endcall -%}
        {%- endif -%}
    </{%- if options.fieldset %}fieldset{% else %}div{% endif %}>
{% endmacro %}

{# formInput label item #}
{% macro label(id, for, class, dataset, options) %}
    <{%- if options.tag %}{{options.tag}}{% else %}label{% endif %}
        {%- if id %} id="{{id}}"{% endif %}
        {%- if for %} for="{{for}}"{% endif %}
        {#!- #} class="formInput__label
            {%- for modifier in options.modifier %} formInput__label--{{ modifier }}{% endfor -%}
            {%- if class %} {{ class }}{% endif -%}
        "
        {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
    {#!- #}>
        {{- caller() -}}
    </{%- if options.tag %}{{options.tag}}{% else %}label{% endif %}>
{% endmacro %}

{# formInput input wrapper item #}
{% macro wrapper(id, class, dataset, options) %}
    <{%- if options.tag %}{{options.tag}}{% else %}div{% endif %}
        {%- if id %} id="{{id}}"{% endif %}
        {%- if options.for %} for="{{id}}"{% endif %}
        {#!- #} class="formInput__wrapper
            {%- for modifier in options.modifier %} formInput__wrapper--{{ modifier }}{% endfor -%}
            {%- if class %} {{ class }}{% endif -%}
        "
        {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
    {#!- #}>
        {{- caller() -}}
    </{%- if options.tag %}{{options.tag}}{% else %}div{% endif %}>
{% endmacro %}

{# formInput input item #}
{% macro input(id, class, dataset, options) %}
    {%- if options.type == 'textarea' and
        options.type == 'text' and
        options.type == 'number' and
        options.type == 'email' and
        options.type == 'tel' and
        options.type == 'password' and
        options.type == 'url' and
        options.type == 'search' and
        options.type == 'date' and
        options.type == 'datetime-local' and
        options.type == 'month' and
        options.type == 'week' and
        options.type == 'time' 
    -%}
        {{ textInput(id, class, dataset, options) }}
    {%- endif -%}
{% endmacro %}

{# formInput textInput item #}
{% macro textInput(id, class, dataset, options) %}
    {%- if options.type == 'textarea'-%}
        <textarea
            {#!- #} id="{{- id -}}"
            {#!- #} class="formInput__input formInput__input--textInput formInput__input--textarea
                {%- for modifier in options.modifier %} formInput__input--{{ modifier }}{% endfor -%}
                {%- if class %} {{ class }}{% endif -%}
            "
            {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
            {%- if options.autofocus %} autofocus{%- endif -%}
            {%- if options.cols %} cols="{{cols}}"{%- endif -%}
            {%- if options.dirname %} dirname="{{options.dirname}}"{%- endif -%}
            {%- if options.form %} form="{{options.form}}"{%- endif -%}
            {%- if options.maxlength %} maxlength="{{options.maxlength}}"{%- endif -%}
            {%- if options.name %} name="{{options.name}}"{%- endif -%}
            {%- if options.placeholder %} placeholder="{{options.placeholder}}"{%- endif -%}
            {%- if options.rows %} rows="{{options.rows}}"{%- endif -%}
            {%- if options.wrap %} wrap="{{options.wrap}}"{%- endif -%}
            {%- if options.modifier -%}
                {%- if 'disabled' in options.modifier %} disabled{%- endif -%}
                {%- if 'readonly' in options.modifier %} readonly{%- endif -%}
                {%- if 'required' in options.modifier %} required{%- endif -%}
            {%- endif -%}
        {#!- #}>{{options.value}}</textarea>
    {%- else -%}
      <input
          {#!- #} id="{{- id -}}"
          {#!- #} class="formInput__input formInput__input--textInput formInput__input--{%- if options.type -%}{{options.type}}{%- else -%}text{%- endif -%}
              {%- for modifier in options.modifier %} formInput__input--{{ modifier }}{% endfor -%}
              {%- if class %} {{ class }}{% endif -%}
          "
          {#!- #} type="
              {%- if options.type -%}
                  {{options.type}}
              {%- else -%}
                  text
              {%- endif -%}
          "
          {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
          {#!- #} value="{{options.value}}"
          {%- if options.autocomplete %} autocomplete="{{options.autocomplete}}"{%- endif -%}
          {%- if options.autofocus %} autofocus{%- endif -%}
          {%- if options.dirname %} dirname="{{options.dirname}}"{%- endif -%}
          {%- if options.form %} form="{{options.form}}"{%- endif -%}
          {%- if options.height %} form="{{options.height}}"{%- endif -%}
          {%- if options.list %} list="{{id}}Datalist"{%- endif -%}
          {%- if options.max %} max="{{options.max}}"{%- endif -%}
          {%- if options.maxlength %} maxlength="{{options.maxlength}}"{%- endif -%}
          {%- if options.min %} min="{{options.min}}"{%- endif -%}
          {%- if options.name %} name="{{options.name}}"{%- endif -%}
          {%- if options.pattern %} pattern="{{options.pattern}}"{%- endif -%}
          {%- if options.placeholder %} placeholder="{{options.placeholder}}"{%- endif -%}
          {%- if options.size %} size="{{options.size}}"{%- endif -%}
          {%- if options.width %} width="{{options.width}}"{%- endif -%}
          {%- if options.modifier -%}
              {%- if 'disabled' in options.modifier %} disabled{%- endif -%}
              {%- if 'readonly' in options.modifier %} readonly{%- endif -%}
              {%- if 'required' in options.modifier %} required{%- endif -%}
          {%- endif -%}
      {#!- #} />
    {%- endif -%}
{% endmacro %}

{# formInput note item #}
{% macro note(id, class, dataset, options) -%}
    <{%- if options.tag %}{{options.tag}}{% else %}p{% endif %}
        {%- if id %} id="{{id}}"{% endif %}
        {#!- #} class="formInput__note
            {%- for modifier in options.modifier %} formInput__note--{{ modifier }}{% endfor -%}
            {%- if class %} {{ class }}{% endif -%}
        "
        {%- for key, value in dataset %} data-{{key | toDataset}}="{{value}}"{%- endfor -%}
    {#!- #}>
        {{- caller() -}}
    </{%- if options.tag %}{{options.tag}}{% else %}p{% endif %}>
{%- endmacro %}
